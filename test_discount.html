<!DOCTYPE html>
<html>
<head>
    <title>æ¸¬è©¦å„ªæƒ è¨­å®š</title>
    <style>
        body { font-family: Arial; padding: 20px; background: #f0f8ff; }
        .product { 
            background: white; 
            padding: 20px; 
            margin: 10px 0; 
            border-radius: 10px; 
            border-left: 5px solid #1976d2;
        }
        .discount { color: #ff5252; font-weight: bold; }
        .normal { color: #1976d2; }
        pre { background: #f5f5f5; padding: 10px; border-radius: 5px; }
        button { 
            background: #1976d2; 
            color: white; 
            border: none; 
            padding: 10px 20px; 
            border-radius: 5px; 
            cursor: pointer;
            margin: 5px;
        }
    </style>
</head>
<body>
    <h1>ğŸ” æ¸¬è©¦å„ªæƒ è¨­å®š</h1>
    
    <button onclick="checkProducts()">æª¢æŸ¥å•†å“è³‡æ–™</button>
    <button onclick="checkDatabase()">æª¢æŸ¥è³‡æ–™åº«</button>
    
    <div id="result"></div>

    <script>
        async function checkProducts() {
            const result = document.getElementById('result');
            result.innerHTML = 'è¼‰å…¥ä¸­...';
            
            try {
                const response = await fetch('php/get_products.php?t=' + Date.now());
                const data = await response.json();
                
                let html = '<h2>å•†å“è³‡æ–™ï¼š</h2>';
                
                if (data.success && data.data) {
                    data.data.forEach(product => {
                        const hasDiscount = product.discount_price && product.discount_price > 0;
                        html += `
                            <div class="product">
                                <h3>${product.name}</h3>
                                <p>åŸåƒ¹: $${product.price}</p>
                                <p class="${hasDiscount ? 'discount' : 'normal'}">
                                    å„ªæƒ åƒ¹: ${hasDiscount ? '$' + product.discount_price : 'ç„¡å„ªæƒ '}
                                </p>
                                <p>æœ€å¾Œæ›´æ–°: ${product.discount_updated_at || 'å¾æœª'}</p>
                                <p>æ›´æ–°è€…: ${product.discount_updated_by || '-'}</p>
                            </div>
                        `;
                    });
                } else {
                    html += '<p class="discount">ç„¡æ³•è¼‰å…¥å•†å“è³‡æ–™</p>';
                }
                
                html += '<h3>åŸå§‹è³‡æ–™ï¼š</h3>';
                html += `<pre>${JSON.stringify(data, null, 2)}</pre>`;
                
                result.innerHTML = html;
            } catch (error) {
                result.innerHTML = `<p class="discount">éŒ¯èª¤: ${error.message}</p>`;
            }
        }
        
        async function checkDatabase() {
            const result = document.getElementById('result');
            result.innerHTML = 'è¼‰å…¥ä¸­...';
            
            try {
                const response = await fetch('php/check_discounts.php');
                const text = await response.text();
                result.innerHTML = text;
            } catch (error) {
                result.innerHTML = `<p class="discount">éŒ¯èª¤: ${error.message}</p>`;
            }
        }
    </script>
</body>
</html>